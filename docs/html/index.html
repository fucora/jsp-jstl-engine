<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>quick start</title>
<meta name="keywords" content="test"/>
<meta name="description" content="test"/>
<meta name="robots" content="all"/>
<meta name="googlebot" content="all"/>
<meta name="baiduspider" content="all"/>
<meta name="copyright" content="All Rights Reserved 版权所有 test"/>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
<link rel="shortcut icon" href="/favicon.ico"/>
<link rel="stylesheet" type="text/css" href="resource/css/doc.css"/>
<link type="text/css" rel="stylesheet" href="resource/sh/style/shCoreEclipse.css"/>
<link type="text/css" rel="stylesheet" href="resource/sh/style/shThemeEclipse.css"/>
<script type="text/javascript" src="resource/sh/shCore.js"></script>
<script type="text/javascript" src="resource/sh/shAutoloader.js"></script>
</head>
<body>
<div class="wrap">
    <div class="navbar">
        <em class="home"></em><a href="/index.html">home</a>
        <em></em><a href="/index.html">index</a>
    </div>
</div>
<div class="wrap">
    <h1 class="sk-h1">Ayada</h1>
    <div class="dir"></div>
    <h2 class="sk-h2">1 Ayada简介</h2>
    <div class="sk-content">
        <p>Ayada是一个Java版的采用jstl语法的模板引擎。所有的实现均于jsp中的jstl一样。对于习惯使用jstl的人来说几乎没有任何学习成本。</p>
        <ul class="sk-list">
            <li><p>简单，学习成本低，对于使用jstl的人来说没有任何学习成本。</p></li>
            <li><p>零配置，不需要任何配置文件，也可以指定配置文件，配置文件简单明了。</p></li>
            <li><p>可插拔的模块设计，模板加载方式，el引擎，运行模式均可通过不同的实现替换。</p></li>
            <li><p>多种方式自定义标签，原生的java代码自定义标签或者直接通过页面自定义标签。</p></li>
            <li><p>引擎层支持自定义el转码，不需要对el表达式的输出做html转码，防止xss注入。</p></li>
            <li><p>简单快速的标签重写功能，专门针对用模板生成模板。</p></li>
            <li><p>支持解释模式和编译模式，解释模式适合只需要在内存中运行的模板。编译模式性能更好。</p></li>
        </ul>
    </div>
    <h2 class="sk-h2">2 快速开始</h2>
    <h3 class="sk-h3">2.1 在控制台应用中使用</h3>
    <div class="sk-content">
        <div class="sk-code">
            <pre class="brush: java;">
            public static void main(String[] args) {
                try {
                    StringWriter out = new StringWriter();
                    Ayada.execute("123<c:if test=\"${1 == 1}\">abc</c:if>xyz", null, out);
                    System.out.println(out.toString());
                }
                catch(Exception e) {
                    logger.warn(e.getMessage(), e);
                }
            }
            </pre>
        </div>
    </div>

    <h3 class="sk-h3">2.2 在web应用中使用</h3>
    <div class="sk-content">
        <p>首先配置web.xml</p>
        <div class="sk-code">
            <pre class="brush: xml;">
                <filter>
                    <filter-name>TemplateFilter</filter-name>
                    <filter-class>com.skin.ayada.web.filter.TemplateFilter</filter-class>
                    <init-param>
                        <param-name>home</param-name>
                        <param-value>/template</param-value>
                    </init-param>
                    <init-param>
                        <param-name>template-factory</param-name>
                        <param-value>com.skin.ayada.template.JspTemplateFactory</param-value>
                    </init-param>
                    <init-param>
                        <param-name>jsp-work</param-name>
                        <param-value>context: /WEB-INF/ayada</param-value>
                    </init-param>
                </filter>
                <filter-mapping>
                    <filter-name>TemplateFilter</filter-name>
                    <url-pattern>/template/*</url-pattern>
                    <dispatcher>FORWARD</dispatcher>
                    <dispatcher>ERROR</dispatcher>
                </filter-mapping>
            </pre>
        </div>
        <p>对应的servlet</p>

        <div class="sk-code">
            <pre class="brush: java;">
            public void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
                this.forward(request, response, "/template/hello.jsp");
            }
            </pre>
        </div>
    </div>

    <h3 class="sk-h3">2.3 自定义模板引擎</h3>
    <div class="sk-content">
        <div class="sk-code">
            <pre class="brush: java;">
            public void main(String[] args) {
                SourceFactory sourceFactory = new DefaultSourceFactory();
                TemplateFactory templateFactory = new TemplateFactory();
                ExpressionFactory expressionFactory = new DefaultExpressionFactory();
                sourceFactory.setHome("D:\\myapp\template");
                sourceFactory.setSourcePattern("jsp,jspx");

                if(logger.isInfoEnabled()) {
                    logger.info("sourceFactory: " + sourceFactory.getClass().getName());
                    logger.info("templateFactory: " + templateFactory.getClass().getName());
                    logger.info("expressionFactory: " + expressionFactory.getClass().getName());
                }

                TemplateContext templateContext = new DefaultTemplateContext(realPath, "UTF-8");
                templateContext.setSourceFactory(sourceFactory);
                templateContext.setTemplateFactory(templateFactory);
                templateContext.setExpressionFactory(expressionFactory);

                Map<String, Object> context = new HashMap<String, Object>();
                context.put("user", "xuesong.net");
                StringWriter writer = new StringWriter();

                templateContext.execute("/hello.jsp", context, Writer writer);
                System.out.println(writer.toString());
            }
            </pre>
        </div>
    </div>

    <h2 class="sk-h2">3 指令系统</h2>
    <div class="sk-content">
        <p>Ayada的语法包括三部分，分别是指令，标签和脚本，下面将分别叙述。</p>
    </div>
    <h3 class="sk-h3">3.1 指令系统</h2>
    <div class="sk-content">
        <p>Ayada的指令共有6个，都是编译指令，只在编译期生效。</p>
    </div>
    <div class="sk-content">
        <p class="bb">t:taglib</p>
        <div class="sk-code">
            <pre class="brush: xml;">
            <t:taglib prefix="c" uri="http://localhost/ayada-default"/>
            </pre>
        </div>
        <p>t:taglib 指令是编译指令，只在编译器生效，用来导入标签库。编译器根据uri指定的路径到classpath下加载指定的标签库。</p>
    </div>
    <div class="sk-content">
        <p class="bb">t:import</p>
        <div class="sk-code">
            <pre class="brush: xml;">
            <t:import name="c:if" className="com.skin.ayada.jstl.core.IfTag" bodyContent="tagdependent" description="if标签"/>
            </pre>
        </div>
        <p>bodyContent - 取值只能是：tagdependent|jsp|empty</p>
        <p>jsp - 子节点可以是任何内容。这个也是默认值。</p>
        <p>tagdependent - 子节点只能是标签，任何文本内容都会在编译器被忽略掉。</p>
        <p>empty - 不允许存在任何子节点。</p>
        <p>t:import 指令是编译指令，只在编译期生效，用来导入标签一个标签。</p>
    </div>
    <div class="sk-content">
        <p class="bb">t:rename</p>
        <div class="sk-code">
            <pre class="brush: xml;">
            <t:rename name="d:if" from="c:if"/>
            </pre>
        </div>
        <p>t:import 指令是编译指令，将已经导入的标签重命名为新的名字。只针对重命名之后的内容生效。</p>
    </div>
    <div class="sk-content">
        <p class="bb">t:include</p>
        <div class="sk-code">
            <pre class="brush: xml;">
            <t:include file="/include/script.html" type="script" encoding="UTF-8"/>
            </pre>
        </div>
        <p>file - 必选 文件路径。</p>
        <p>type - 可选 取值: script|static，script: 被包含的文件是将会作为模板文件编译，static: 被包含文件作为普通的文本内容，无论它是什么内容。</p>
        <p>encoding - 可选 文件编码，默认是utf-8。</p>
        <p>t:include 指令是编译指令，包含一个文件。</p>
    </div>
    <div class="sk-content">
        <p class="bb">t:text</p>
        <div class="sk-code">
            <pre class="brush: xml;">
            <t:text escape="xml"><c:if test="${1==1}">hello</c:if></t:text>
            </pre>
        </div>
        <p>escape - 可选 是否做xml编码。</p>
        <p>t:text 指令是编译指令，其中的任何内容都作为文本处理，不允许嵌套。</p>
    </div>
    <div class="sk-content">
        <p class="bb">t:comment</p>
        <div class="sk-code">
            <pre class="brush: xml;">
            <t:comment><c:if test="${1==1}">hello</c:if></t:comment>
            </pre>
        </div>
        <p>t:comment 指令是编译指令，其中的任何内容都作为注释被忽略，不允许嵌套。</p>
    </div>

    <h3 class="sk-h3">3.2 内置的标签列表</h3>
    <div class="sk-content">
        <p>内置标签是Ayada内置的常用标签，你也可以重新定义一套自己的标签库并使用。关于自定义标签请参考<a href="#6.1.1">6.1.1 自定义标签</a>章节。</p>
        <div class="sk-code">
            <table>
                <tr>
                    <td style="width: 200px">标签</td>
                    <td style="width: 200px">实现</td>
                    <td style="width: 200px">类型</td>
                    <td style="width: 200px">示例</td>
                </tr>
                <tr>
                    <td>c:dependent</td>
                    <td>com.skin.ayada.jstl.core.DependentTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:command</td>
                    <td>com.skin.ayada.jstl.core.DependentTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:if</td>
                    <td>com.skin.ayada.jstl.core.IfTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:set</td>
                    <td>com.skin.ayada.jstl.core.SetTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:remove</td>
                    <td>com.skin.ayada.jstl.core.RemoveTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:out</td>
                    <td>com.skin.ayada.jstl.core.OutTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:ifout</td>
                    <td>com.skin.ayada.jstl.core.IfOutTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:nvl</td>
                    <td>com.skin.ayada.jstl.core.NVLTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:catch</td>
                    <td>com.skin.ayada.jstl.core.CatchTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:each</td>
                    <td>com.skin.ayada.jstl.core.ForEachTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:forEach</td>
                    <td>com.skin.ayada.jstl.core.ForEachTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:forTokens</td>
                    <td>com.skin.ayada.jstl.core.ForTokensTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:choose</td>
                    <td>com.skin.ayada.jstl.core.ChooseTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:when</td>
                    <td>com.skin.ayada.jstl.core.WhenTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:otherwise</td>
                    <td>com.skin.ayada.jstl.core.OtherwiseTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:continue</td>
                    <td>com.skin.ayada.jstl.core.ContinueTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:break</td>
                    <td>com.skin.ayada.jstl.core.BreakTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:comment</td>
                    <td>com.skin.ayada.jstl.core.CommentTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:escape</td>
                    <td>com.skin.ayada.jstl.core.EscapeTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:print</td>
                    <td>com.skin.ayada.jstl.core.PrintTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:exit</td>
                    <td>com.skin.ayada.jstl.core.ExitTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:buffer</td>
                    <td>com.skin.ayada.jstl.core.BufferTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:bean</td>
                    <td>com.skin.ayada.jstl.core.BeanTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:param</td>
                    <td>com.skin.ayada.jstl.core.ParameterTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:property</td>
                    <td>com.skin.ayada.jstl.core.PropertyTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:attribute</td>
                    <td>com.skin.ayada.jstl.core.AttributeTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:constructor</td>
                    <td>com.skin.ayada.jstl.core.ConstructorTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:map</td>
                    <td>com.skin.ayada.jstl.core.MapTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:list</td>
                    <td>com.skin.ayada.jstl.core.ListTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:entry</td>
                    <td>com.skin.ayada.jstl.core.AttributeTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:element</td>
                    <td>com.skin.ayada.jstl.core.ElementTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:execute</td>
                    <td>com.skin.ayada.jstl.core.ExecuteTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:xml</td>
                    <td>com.skin.ayada.jstl.core.OutputTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:output</td>
                    <td>com.skin.ayada.jstl.core.OutputTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:include</td>
                    <td>com.skin.ayada.taglib.ActionTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:invoke</td>
                    <td>com.skin.ayada.taglib.ActionTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:layout</td>
                    <td>com.skin.ayada.taglib.ActionTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:action</td>
                    <td>com.skin.ayada.taglib.ActionTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:test</td>
                    <td>com.skin.ayada.jstl.core.TestTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:tryCatchTest</td>
                    <td>com.skin.ayada.jstl.core.TryCatchTestTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>c:scrollpage</td>
                    <td>com.skin.ayada.taglib.ScrollPage</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>f:substring</td>
                    <td>com.skin.ayada.jstl.fmt.SubstringTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:formatDate</td>
                    <td>com.skin.ayada.jstl.fmt.DateFormatTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:formatNumber</td>
                    <td>com.skin.ayada.jstl.fmt.NumberFormatTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:parseDate</td>
                    <td>com.skin.ayada.jstl.fmt.ParseDateTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:parseNumber</td>
                    <td>com.skin.ayada.jstl.fmt.ParseNumberTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:setTimeZone</td>
                    <td>com.skin.ayada.jstl.fmt.SetTimeZoneTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:timeZone</td>
                    <td>com.skin.ayada.jstl.fmt.TimeZoneTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:setLocale</td>
                    <td>com.skin.ayada.jstl.fmt.SetLocaleTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:bundle</td>
                    <td>com.skin.ayada.jstl.fmt.BundleTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:setBundle</td>
                    <td>com.skin.ayada.jstl.fmt.SetBundleTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:message</td>
                    <td>com.skin.ayada.jstl.fmt.MessageTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>fmt:param</td>
                    <td>com.skin.ayada.jstl.fmt.FmtParamTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>sql:connect</td>
                    <td>com.skin.ayada.jstl.sql.ConnectTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>sql:execute</td>
                    <td>com.skin.ayada.jstl.sql.SqlTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>sql:query</td>
                    <td>com.skin.ayada.jstl.sql.QueryTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>sql:parse</td>
                    <td>com.skin.ayada.jstl.sql.CreateParseTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>sql:create</td>
                    <td>com.skin.ayada.jstl.sql.CreateParseTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>sql:insert</td>
                    <td>com.skin.ayada.jstl.sql.InsertParseTag</td>
                    <td>jsp</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>io:copy</td>
                    <td>com.skin.ayada.jstl.io.CopyTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>io:delete</td>
                    <td>com.skin.ayada.jstl.io.DeleteTag</td>
                    <td>tagdependent</td>
                    <td>xxx</td>
                </tr>
                <tr>
                    <td>io:mkdir</td>
                    <td>com.skin.ayada.jstl.io.MakeDirTag</td>
                    <td>empty</td>
                    <td>xxx</td>
                </tr>
            </table>
        </div>
    </div>

    <h3 class="sk-h2">3.3 常用标签介绍</h3>
    <div class="sk-content">
        <p>一般标签（例如: c:if, c:set, c:out, c:forEach等）就不介绍了，与jstl中的使用方式一样。此处只介绍一些在开发中很常用的开发模式，但是jstl又没有提供或者不支持的功能。</p>
    </div>
    <h4 class="sk-h4">c:escape</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;"><c:escape encoder="${myHtmlEncoder}"/></div>
        <p>参数encoder接受两种参数：</p>
        <p>对象: 必须实现com.skin.ayada.runtime.ELEncoder。</p>
        <p>字符串: 目前默认支持只xml或者html。</p>
        <p>一般情况下不需要设置，默认对el表达式做html编码之后输出。如果不需要对输出做编码，可以使用c:out标签输出。</p>
    </div>

    <h4 class="sk-h4">c:print</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;"><c:print out="${pageContext}" value="${user}"/></div>
        <p>out：java.io.Writer - 可选 默认是页面的writer对象，也可以是pageContext对象。</p>
        <p>value: java.lang.Object</p>
        <p>打印对象，通常用来调试。</p>
    </div>

    <h4 class="sk-h4">c:exit</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;"><c:exit/></div>
        <p>立即终止当前页面渲染。</p>
    </div>

    <h3 class="sk-h3">c:buffer</h3>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;"><c:buffer var="jspPart">Hello World !</c:buffer></div>
        <p>var：java.lang.String - 必选 缓存的变量名称，支持el表达式。</p>
        <p>将该标签的内容执行之后放到pageContext中。</p>
    </div>

    <h4 class="sk-h4">c:bean</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;">
            <c:bean name="myBean" className="test.MyBean">
                <c:constructor type="java.lang.Integer" value="1"></c:constructor>
                <c:constructor type="java.lang.Integer" value="1"></c:constructor>
                <c:constructor type="java.lang.Integer" value="1"></c:constructor>
            </c:bean></div>
        <p>name：java.lang.String - 必选 bean名称。</p>
        <p>className：java.lang.String - 必选 class名称。</p>
        <p>根据指定的className创建一个bean对象。</p>
    </div>

    <h4 class="sk-h4">c:map</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;">
            <c:map name="myMap">
                <c:entry name="a" value="${myVar1}"></c:entry>
                <c:entry name="b" value="${myVar2}"></c:entry>
                <c:entry name="c" value="${myVar3}"></c:entry>
            </c:bean></div>
        <p>name：java.lang.String - 必选 map名称。</p>
        <p>构建一个map对象放到pageContext中。</p>
    </div>

    <h4 class="sk-h4">c:list</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;">
            <c:list name="myList">
                <c:element value="${myVar1}"></c:element>
                <c:element value="${myVar2}"></c:element>
                <c:element value="${myVar3}"></c:element>
            </c:list></div>
        <p>name：java.lang.String - 必选 map名称。</p>
        <p>构建一个list对象放到pageContext中。</p>
    </div>
    <h4 class="sk-h4">c:xml</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;">
            <c:xml file="${savePath}/1.txt" escapeXml="false" encoding="utf-8" out="true" trim="true">
                <h1>Hello World !</h1>
            </c:xml></pre></div>
        <p>file：java.lang.String - 可选 输出内容到指定文件。</p>
        <p>escapeXml：java.lang.String - 可选 是否做xml编码。</p>
        <p>encoding：java.lang.String - 可选 文件编码。</p>
        <p>out：java.lang.String - 可选 是否同步输出到当前页面。</p>
        <p>trim：java.lang.String - 可选 是否trim之后输出。</p>
        <p>将内容输出到指定位置。</p>
    </div>

    <h4 class="sk-h4">c:output</h4>
    <div class="sk-content">
        <p>完全同c:xml，只是标签名称不一样。</p>
    </div>

    <h4 class="sk-h4">c:include</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;">
            <c:include page="/user/userList.jsp">
                <c:param name="user1" value="${myUser}"></c:param>
                <c:param name="user2" value="${myUser}"></c:param>
            </c:include>
        </pre></div>
        <p>包含一个页面。</p>
        <p>此处的包含不同于t:include，t:include是编译指令，在编译期间先加载进来再一起编译，是静态包含，c:include是动态包含，被包含的页面将会单独编译，单独运行，然后把执行结果输出到当前页面。</p>
        <p>因此被包含的页面与当前页面在运行环境上是完全隔离的，互相之间变量不会相互污染。</p>
    </div>

    <h4 class="sk-h4">c:invoke</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;">
            <c:invoke page="/user/userList.jsp">
                <c:param name="user1" value="${myUser}"></c:param>
                <c:param name="user2" value="${myUser}"></c:param>
            </c:invoke>
        </pre></div>
        <p>完全同c:include，只是标签名称不一样。可以用来调用另外一个模板。</p>
    </div>

    <h4 class="sk-h4">c:layout</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;">
            <c:layout page="/user/userList.jsp">
                <c:param name="user1" value="${myUser}"></c:param>
                <c:param name="user2" value="${myUser}"></c:param>
            </c:layout>
        </pre></div>
        <p>完全同c:include，只是标签名称不一样。可以用来实现layout布局。</p>
    </div>

    <h4 class="sk-h4">c:action</h4>
    <div class="sk-content">
        <div class="sk-code"><pre class="brush: xml;">
            <c:action className="test.UserAction" method="execute" page="/user/userList.jsp">
                <c:param name="user1" value="${myUser}"></c:param>
                <c:param name="user2" value="${myUser}"></c:param>
            </c:action>
        </pre></div>
        <p>className：java.lang.String - 可选 要执行的类。</p>
        <p>execute：java.lang.String - 可选 要执行的方法。</p>
        <p>page：java.lang.String - 可选 要渲染的页面。</p>
        <p>完全同c:include，只是标签名称不一样。</p>
        <p>c:include, c:invoke, c:layout, c:action实际上都是同一个标签，为了区分功能不同才定义出来不同的标签。</p>
        <p>c:action用来实现类似struts的s:action标签功能。它可以在调用完一个指定的类之后再渲染指定的页面。类相当于controller，页面相当于view。</p>
        <p>最重要的是被包含的页面与当前页面在运行环境上是完全隔离的，互相之间变量不会相互污染。</p>
        <p>由于变量之间互相隔离，<b>因此可以很方便的用它来自定义标签。</b></p>
    </div>

    <h2 class="sk-h2">4 用模版生成模版</h2>
    <div class="sk-content">
        <p>用模版生成模版有三种方法, 三种方法都是只针对当前页面生效, 不会影响其他页面.</p>
        <p># 方法一: 重新定义全部标签</p>
        <p>1). 通过t:taglib指令覆盖全部指令, 将前缀从默认的c改成d</p>
        <div class="sk-code"><pre class="brush: xml;"><t:taglib prefix="d" uri="http://localhost/ayada-taglib-mytest"/></pre></div>
        <p>其中ayada-taglib-mytest.xml文件必须存在, 编译期将从classpath加载ayada-taglib-mytest.xml文件.</p>
        <p>也可以直接引入ayada-taglib-default.xml覆盖系统默认的全部标签。无需担心库文件中定义的标签名称包含的前缀，导入时会使用新的前缀替换。</p>
        <p>ayada-taglib-default.xml是系统自带的标签库定义文件.</p>
        <p>2). 模板代码如下</p>
        <div class="sk-code">
            <pre class="brush: xml;">
            <t:taglib prefix="d" uri="http://localhost/ayada-taglib-mytest"/>
            <c:comment>这是一个用模版生成模版的示例</c:comment>
            <d:if test="${1 == 1}">
                <c:if test="${?a > 1}">
                    <h1>${?user.name}</h1>
                </c:if>
            </d:if>
            </pre>
        </div>
        <p>输出:</p>
        <div class="sk-code"><pre class="brush: xml;">
            <c:if test="${a > 1}">
                <h1>${user.name}</h1>
            </c:if>
        </pre></div>

        <p># 方法二: 重新定义部分标签</p>
        <p>1). 通过t:rename指令重命名指定指令.</p>
        <p>2). 模板代码如下</p>
        <div class="sk-code"><pre class="brush: xml;">
            <t:rename name="d:if" from="c:if"/>
            <c:comment>这是一个用模版生成模版的示例</c:comment>

            <d:if test="${1 == 1}">
                <c:if test="${?a > 1}">
                    <h1>${?user.name}</h1>
                </c:if>
            </d:if>
        </pre></div>
        <p>输出:</p>
        <div class="sk-code"><pre class="brush: xml;">
            <c:if test="${a > 1}">
                <h1>${user.name}</h1>
            </c:if>
        </pre></div>

        <p># 方法三: 使用t:text指令</p>
        <p>注：该方法只适合静态内容, 不适合动态内容.</p>
        <p>示例：</p>
        <div class="sk-code"><pre class="brush: xml;">
            <t:text>
                <c:if test="${a > 1}">
                    <h1>${user.name}</h1>
                </c:if>
            </t:text>
        </pre></div>

        <p>输出: </p>
        <div class="sk-code"><pre class="brush: xml;">
            <c:if test="${a > 1}">
                <h1>${user.name}</h1>
            </c:if>
        </pre></div>
        <p>t:text指令是在编译期执行的, 并且不允许嵌套. 编译期遇到t:text指令, 就会把其中的内容全部作为文本加载, 其中的el表达式也不需要使用特殊写法.</p>
        <p>因此中间任何内容都不会动态执行, 所以它只适合静态内容.</p>

        <p># 生成EL表达式.</p>
        <p>以上两种方法都是针对标签的重定义, 对于el表达式只需要在el表达式的前面加上?即可. 这样el表达式将会原样输出.</p>
        <p>例如: </p>
        <div class="sk-code"><pre class="brush: xml;"><h1>${?user.name}</h1></pre></div>
            
        <p>输出:
        <div class="sk-code"><pre class="brush: xml;"><h1>${user.name}</h1></pre></div>
    </div>

    <h2 class="sk-h2">5. 自定义工具类</h2>
    <div class="sk-content">
        <p>创建ayada.properties文件</p>
        <p>set util=com.skin.ayada.jstl.util.BeanUtil                                 # 定义一个全局工具类</p>
    </div>

    <h2 class="sk-h2">6. 自定义标签</h2>
    <div class="sk-content">
        <p>Ayada的API与jsp的jstl的API基本保持一致，除了包名不一样其他的类名都完全一致，类结构也一模一样。所以无需了解Ayada的自定义标签是怎么实现的，只需参考jstl的自定义标签即可。webapp目录下包含了绝大部分的代码示例和测试用例，这些文件基本上都以某个具体的标签名命名，从文件名就可以很容易看出来是关于那个标签的用法的。唯一需要做的是把引入的jstl的类的包名替换成Ayada的包名即可。</p>
        <p>下面是c:out标签的默认实现，示例代码：</p>
        <div class="sk-code">
            <pre class="brush: java;">
            package com.skin.ayada.jstl.core;

            import java.io.IOException;
            import java.io.Writer;

            import com.skin.ayada.runtime.JspWriter;
            import com.skin.ayada.runtime.PageContext;
            import com.skin.ayada.tagext.BodyContent;
            import com.skin.ayada.tagext.BodyTag;
            import com.skin.ayada.tagext.BodyTagSupport;
            import com.skin.ayada.tagext.Tag;

            /**
             * <p>Title: OutTag</p>
             * <p>Description: </p>
             * <p>Copyright: Copyright (c) 2006</p>
             * @author xuesong.net
             * @version 1.0
             */
            public class OutTag extends BodyTagSupport {
                private Object value = null;
                private String defaultValue = null;
                private boolean escapeXml = false;

                @Override
                public int doStartTag() throws Exception {
                    if(this.value != null) {
                        OutTag.print(this.pageContext, this.value, this.escapeXml);
                        return Tag.SKIP_BODY;
                    }

                    if(this.defaultValue != null) {
                        OutTag.print(this.pageContext, this.defaultValue, this.escapeXml);
                        return Tag.SKIP_BODY;
                    }
                    return BodyTag.EVAL_BODY_BUFFERED;
                }

                /**
                 * @return int
                 */
                @Override
                public int doEndTag() throws Exception {
                    BodyContent bodyContent = this.getBodyContent();

                    if(bodyContent != null) {
                        print(this.pageContext, bodyContent.getString().trim(), this.escapeXml);
                    }
                    return EVAL_PAGE;
                }

                /**
                 * @param out
                 * @param value
                 * @param escapeXml
                 */
                public static void write(Writer out, Object value, boolean escapeXml) throws IOException {
                    if(value != null) {
                        String content = value.toString();

                        if(escapeXml) {
                            out.write(escape(content));
                        }
                        else {
                            out.write(content);
                        }
                    }
                }

                /**
                 * @param pageContext
                 * @param value
                 * @param escapeXml
                 */
                public static void print(PageContext pageContext, Object value, boolean escapeXml) throws IOException {
                    if(value != null) {
                        String content = value.toString();
                        JspWriter out = pageContext.getOut();

                        if(escapeXml) {
                            out.print(escape(content));
                        }
                        else {
                            out.print(content);
                        }
                    }
                }

                /**
                 * @param source
                 * @return String
                 */
                private static String escape(String source) {
                    if(source == null) {
                        return "";
                    }

                    char c;
                    StringBuilder buffer = new StringBuilder();

                    for(int i = 0, size = source.length(); i < size; i++) {
                        c = source.charAt(i);

                        switch (c) {
                            case '&': {
                                buffer.append("&amp;");
                                break;
                            }
                            case '"': {
                                buffer.append("&quot;");
                                break;
                            }
                            case '<': {
                                buffer.append("&lt;");
                                break;
                            }
                            case '>': {
                                buffer.append("&gt;");
                                break;
                            }
                            case '\'': {
                                buffer.append("&#39;");
                                break;
                            }
                            default : {
                                buffer.append(c);
                                break;
                            }
                        }
                    }
                    return buffer.toString();
                }

                /**
                 * @return the value
                 */
                public Object getValue() {
                    return this.value;
                }

                /**
                 * @param value the value to set
                 */
                public void setValue(Object value) {
                    this.value = value;
                }

                /**
                 * @return boolean
                 */
                public boolean getEscapeXml() {
                    return this.escapeXml;
                }

                /**
                 * @param escapeXml
                 */
                public void setEscapeXml(boolean escapeXml) {
                    this.escapeXml = escapeXml;
                }
            }
            </pre>
        </div>
    </div>

    <h2 class="sk-h2">7 代码示例和测试用例</h2>
    <div class="sk-content">
        <p>在源代码的/webapp目录下包含了绝大部分的代码示例和测试用例，这些文件基本上都以某个具体的标签名命名，从文件名就可以很容易看出来是关于那个标签的用法的。</p>
        <p>com.skin.ayada.template.Main是java调用模板引擎的示例，也可以在命令行下调用。</p>
    </div>
</div>
<div class="h20" style="height: 200px;"></div>
<div class="scrolltop" onclick="window.scrollTo(0, 0)"></div>
<script type="text/javascript">
<!--
function path() {
    var args = arguments;
    var result = [];

    for(var i = 0; i < args.length; i++) {
        result.push(args[i].replace("@", "resource/sh/"));
    }
    return result;
};

var args = path(
    "applescript            @shBrushAppleScript.js",
    "actionscript3 as3      @shBrushAS3.js",
    "bash shell             @shBrushBash.js",
    "coldfusion cf          @shBrushColdFusion.js",
    "cpp c                  @shBrushCpp.js",
    "c# c-sharp csharp      @shBrushCSharp.js",
    "css                    @shBrushCss.js",
    "delphi pascal          @shBrushDelphi.js",
    "diff patch pas         @shBrushDiff.js",
    "erl erlang             @shBrushErlang.js",
    "groovy                 @shBrushGroovy.js",
    "java                   @shBrushJava.js",
    "jfx javafx             @shBrushJavaFX.js",
    "js jscript javascript  @shBrushJScript.js",
    "perl pl                @shBrushPerl.js",
    "php                    @shBrushPhp.js",
    "text plain             @shBrushPlain.js",
    "py python              @shBrushPython.js",
    "ruby rails ror rb      @shBrushRuby.js",
    "sass scss              @shBrushSass.js",
    "scala                  @shBrushScala.js",
    "sql                    @shBrushSql.js",
    "vb vbnet               @shBrushVb.js",
    "xml xhtml xslt html    @shBrushXml.js"
);
SyntaxHighlighter.autoloader.apply(null, args);
SyntaxHighlighter.all();
//-->
</script>
</body>
</html>
